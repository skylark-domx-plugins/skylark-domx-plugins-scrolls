/**
 * skylark-domx-plugins-scrolls - The skylark scrolls plugins library for dom api extension
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx-plugins/skylark-domx-plugins-scrolls/
 * @license MIT
 */
!function(t,e){var i=e.define,require=e.require,s="function"==typeof i&&i.amd,o=!s&&"undefined"!=typeof exports;if(!s&&!i){var n={};i=e.define=function(t,e,i){"function"==typeof i?(n[t]={factory:i,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var i=e.split("/"),s=t.split("/");i.pop();for(var o=0;o<s.length;o++)"."!=s[o]&&(".."==s[o]?i.pop():i.push(s[o]));return i.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):n[t]={factory:null,resolved:!0,exports:i}},require=e.require=function(t){if(!n.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=n[t];if(!module.resolved){var i=[];module.deps.forEach(function(t){i.push(require(t))}),module.exports=module.factory.apply(e,i)||null,module.resolved=!0}return module.exports}}if(!i)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-domx-plugins-scrolls/scrolls",["skylark-langx/skylark"],function(t){return t.attach("domx.plugins.scrolls",{})}),t("skylark-domx-plugins-scrolls/Affix",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(t,e,i,s,o,n,r,l){"use strict";var a=r.Plugin.inherit({klassName:"Affix",pluginName:"domx.affix",options:{offset:0,target:window},_construct:function(e,i){this.overrided(e,i),this.$target=n(this.options.target).on("scroll.affix.data-api",t.proxy(this.checkPosition,this)).on("click.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=this.$(),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()},getState:function(t,e,i,s){var o=this.$target.scrollTop(),n=this.$element.offset(),r=this.$target.height();if(null!=i&&"top"==this.affixed)return o<i&&"top";if("bottom"==this.affixed)return null!=i?!(o+this.unpin<=n.top)&&"bottom":!(o+r<=t-s)&&"bottom";var l=null==this.affixed,a=l?o:n.top,c=l?r:e;return null!=i&&o<=i?"top":null!=s&&a+c>=t-s&&"bottom"},getPinnedOffset:function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(a.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},checkPositionWithEventLoop:function(){setTimeout(t.proxy(this.checkPosition,this),1)},checkPosition:function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,s=e.top,o=e.bottom,r=Math.max(n(document).height(),n(document.body).height());"object"!=typeof e&&(o=s=e),"function"==typeof s&&(s=e.top(this.$element)),"function"==typeof o&&(o=e.bottom(this.$element));var l=this.getState(r,t,s,o);if(this.affixed!=l){null!=this.unpin&&this.$element.css("top","");var c="affix"+(l?"-"+l:""),h=i.create(c+".affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(a.RESET).addClass(c).trigger(c.replace("affix","affixed")+".affix")}"bottom"==l&&this.$element.offset({top:r-t-o})}}});return a.RESET="affix affix-top affix-bottom",r.register(a),l.Affix=a}),t("skylark-domx-plugins-scrolls/InfiniteScroll",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(t,e,i,s,o,n,r,l){"use strict";var a=r.Plugin.inherit({klassName:"InfiniteScroll",pluginName:"domx.infinitescroll",options:{dataSource:null,hybrid:!1,percentage:95},_construct:function(e,i){this.overrided(e,i),this.$element=this.$(),this.$element.addClass("infinitescroll"),this.curScrollTop=this.$element.scrollTop(),this.curPercentage=this.getPercentage(),this.fetchingData=!1,this.$element.on("scroll.domx.infinitescroll",t.proxy(this.onScroll,this)),this.onScroll()},destroy:function(){return this.$element.remove(),this.$element.empty(),this.$element[0].outerHTML},disable:function(){this.$element.off("scroll.domx.infinitescroll")},enable:function(){this.$element.on("scroll.domx.infinitescroll",t.proxy(this.onScroll,this))},end:function(t){var e=n('<div class="infinitescroll-end"></div>');t?e.append(t):e.append("---------"),this.$element.append(e),this.disable()},getPercentage:function(){var t="border-box"===this.$element.css("box-sizing")?this.$element.outerHeight():this.$element.height(),e=this.$element.get(0).scrollHeight;return e>t?t/(e-this.curScrollTop)*100:0},fetchData:function(t){var e,i=n('<div class="infinitescroll-load"></div>'),s=this,o=function(){var t={percentage:s.curPercentage,scrollTop:s.curScrollTop},e=n('<div class="loader"></div>');i.append(e),e.loader(),s.options.dataSource&&s.options.dataSource(t,function(t){var e;i.remove(),t.content&&s.$element.append(t.content),t.end&&(e=!0!==t.end?t.end:void 0,s.end(e)),s.fetchingData=!1})};this.fetchingData=!0,this.$element.append(i),this.options.hybrid&&!0!==t?(e=n('<button type="button" class="btn btn-primary"></button>'),"object"==typeof this.options.hybrid?e.append(this.options.hybrid.label):e.append('<span class="glyphicon glyphicon-repeat"></span>'),e.on("click.domx.infinitescroll",function(){e.remove(),o()}),i.append(e)):o()},onScroll:function(t){this.curScrollTop=this.$element.scrollTop(),this.curPercentage=this.getPercentage(),!this.fetchingData&&this.curPercentage>=this.options.percentage&&this.fetchData()}});return r.register(a),l.InfiniteScroll=a}),t("skylark-domx-plugins-scrolls/scrollingElement",["./scrolls"],function(t){return t.scrollingElement=function(){return document.scrollingElement||document.documentElement}}),t("skylark-domx-plugins-scrolls/ScrollSpy",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins-base","./scrolls"],function(t,e,i,s,o,n,r,l){"use strict";var a=r.Plugin.inherit({klassName:"ScrollSpy",pluginName:"domx.scrollspy",options:{offset:10},_construct:function(e,i){this.overrided(e,i),this.$body=n(document.body),this.$scrollElement=this.$().is(document.body)?n(window):this.$(),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()},getScrollHeight:function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},refresh:function(){var e=this,i="offset",s=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(i="position",s=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=n(this),e=t.data("target")||t.attr("href"),o=/^#./.test(e)&&n(e);return o&&o.length&&o.is(":visible")&&[[o[i]().top+s,e]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},process:function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.getScrollHeight(),s=this.options.offset+i-this.$scrollElement.height(),o=this.offsets,n=this.targets,r=this.activeTarget;if(this.scrollHeight!=i&&this.refresh(),e>=s)return r!=(t=n[n.length-1])&&this.activate(t);if(r&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)r!=n[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(n[t])},activate:function(t){this.activeTarget=t,this.clear();var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',i=n(e).parents("li").addClass("active");i.parent(".dropdown-menu").length&&(i=i.closest("li.dropdown").addClass("active")),i.trigger("activate.scrollspy")},clear:function(){n(this.selector).parentsUntil(this.options.target,".active").removeClass("active")}});return r.register(a),l.ScrollSpy=a}),t("skylark-domx-plugins-scrolls/main",["./scrolls","./Affix","./InfiniteScroll","./scrollingElement","./ScrollSpy"],function(t){return t}),t("skylark-domx-plugins-scrolls",["skylark-domx-plugins-scrolls/main"],function(t){return t})}(i),!s){var r=require("skylark-langx-ns");o?module.exports=r:e.skylarkjs=r}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-plugins-scrolls.js.map
