/**
 * skylark-domx-panels - The skylark spy plugins library for dom api extension
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylark-domx/skylark-domx-spy/
 * @license MIT
 */
!function(t,e){var s=e.define,require=e.require,i="function"==typeof s&&s.amd,o=!i&&"undefined"!=typeof exports;if(!i&&!s){var r={};s=e.define=function(t,e,s){"function"==typeof s?(r[t]={factory:s,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var s=e.split("/"),i=t.split("/");s.pop();for(var o=0;o<i.length;o++)"."!=i[o]&&(".."==i[o]?s.pop():s.push(i[o]));return s.join("/")}(e,t)}),resolved:!1,exports:null},require(t)):r[t]={factory:null,resolved:!0,exports:s}},require=e.require=function(t){if(!r.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var module=r[t];if(!module.resolved){var s=[];module.deps.forEach(function(t){s.push(require(t))}),module.exports=module.factory.apply(e,s)||null,module.resolved=!0}return module.exports}}if(!s)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,require){t("skylark-domx-panels/spy",["skylark-langx/skylark"],function(t){return t.attach("domx.spy",{})}),t("skylark-domx-panels/Affix",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./spy"],function(t,e,s,i,o,r,n,l){"use strict";var a=l.Affix=n.Plugin.inherit({klassName:"Affix",pluginName:"domx.affix",options:{offset:0,target:window},_construct:function(e,s){this.overrided(e,s),this.$target=r(this.options.target).on("scroll.affix.data-api",t.proxy(this.checkPosition,this)).on("click.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=this.$(),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()},getState:function(t,e,s,i){var o=this.$target.scrollTop(),r=this.$element.offset(),n=this.$target.height();if(null!=s&&"top"==this.affixed)return o<s&&"top";if("bottom"==this.affixed)return null!=s?!(o+this.unpin<=r.top)&&"bottom":!(o+n<=t-i)&&"bottom";var l=null==this.affixed,a=l?o:r.top,f=l?n:e;return null!=s&&o<=s?"top":null!=i&&a+f>=t-i&&"bottom"},getPinnedOffset:function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(a.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},checkPositionWithEventLoop:function(){setTimeout(t.proxy(this.checkPosition,this),1)},checkPosition:function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,o=e.bottom,n=Math.max(r(document).height(),r(document.body).height());"object"!=typeof e&&(o=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof o&&(o=e.bottom(this.$element));var l=this.getState(n,t,i,o);if(this.affixed!=l){null!=this.unpin&&this.$element.css("top","");var f="affix"+(l?"-"+l:""),h=s.create(f+".affix");if(this.$element.trigger(h),h.isDefaultPrevented())return;this.affixed=l,this.unpin="bottom"==l?this.getPinnedOffset():null,this.$element.removeClass(a.RESET).addClass(f).trigger(f.replace("affix","affixed")+".affix")}"bottom"==l&&this.$element.offset({top:n-t-o})}}});return a.RESET="affix affix-top affix-bottom",n.register(a),l.Affix=a}),t("skylark-domx-panels/ScrollSpy",["skylark-langx/langx","skylark-domx-browser","skylark-domx-eventer","skylark-domx-noder","skylark-domx-geom","skylark-domx-query","skylark-domx-plugins","./spy"],function(t,e,s,i,o,r,n,l){"use strict";var a=n.Plugin.inherit({klassName:"ScrollSpy",pluginName:"domx.scrollspy",options:{offset:10},_construct:function(e,s){this.overrided(e,s),this.$body=r(document.body),this.$scrollElement=r(element).is(document.body)?r(window):r(element),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()},getScrollHeight:function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},refresh:function(){var e=this,s="offset",i=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(s="position",i=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var t=r(this),e=t.data("target")||t.attr("href"),o=/^#./.test(e)&&r(e);return o&&o.length&&o.is(":visible")&&[[o[s]().top+i,e]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},process:function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,s=this.getScrollHeight(),i=this.options.offset+s-this.$scrollElement.height(),o=this.offsets,r=this.targets,n=this.activeTarget;if(this.scrollHeight!=s&&this.refresh(),e>=i)return n!=(t=r[r.length-1])&&this.activate(t);if(n&&e<o[0])return this.activeTarget=null,this.clear();for(t=o.length;t--;)n!=r[t]&&e>=o[t]&&(void 0===o[t+1]||e<o[t+1])&&this.activate(r[t])},activate:function(t){this.activeTarget=t,this.clear();var e=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',s=r(e).parents("li").addClass("active");s.parent(".dropdown-menu").length&&(s=s.closest("li.dropdown").addClass("active")),s.trigger("activate.scrollspy")},clear:function(){r(this.selector).parentsUntil(this.options.target,".active").removeClass("active")}});return n.register(a),l.ScrollSpy=a}),t("skylark-domx-panels/main",["./spy","./Affix","./ScrollSpy"],function(t){return t}),t("skylark-domx-panels",["skylark-domx-panels/main"],function(t){return t})}(s),!i){var n=require("skylark-langx-ns");o?module.exports=n:e.skylarkjs=n}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-domx-panels.js.map
